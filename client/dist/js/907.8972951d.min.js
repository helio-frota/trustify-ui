"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[907],{65753:(e,t,l)=>{l.d(t,{B:()=>u});var a=l(34629),n=l(63696),r=l(62634),i=l(91106),s=l(44551);const o="--pf-v5-c-description-list--GridTemplateColumns--min",c="--pf-v5-c-description-list__term--width",m="--pf-v5-c-description-list--m-horizontal__term--width",d=(e,t)=>{const l=t;return Object.keys(l||{}).reduce(((t,a)=>"default"===a?Object.assign(Object.assign({},t),{[e]:l[a]}):Object.assign(Object.assign({},t),{[`${e}-on-${a}`]:l[a]})),{})},u=e=>{var{className:t="",children:l=null,isHorizontal:u=!1,isAutoColumnWidths:p,isAutoFit:E,isInlineGrid:h,isCompact:b,isFluid:y,isFillColumns:f,displaySize:g="default",columnModifier:v,autoFitMinModifier:A,termWidth:P,horizontalTermWidthModifier:T,orientation:C,style:x}=e,N=(0,a.__rest)(e,["className","children","isHorizontal","isAutoColumnWidths","isAutoFit","isInlineGrid","isCompact","isFluid","isFillColumns","displaySize","columnModifier","autoFitMinModifier","termWidth","horizontalTermWidthModifier","orientation","style"]);return E&&A&&(x=Object.assign(Object.assign({},x),d(o,A))),P&&(x=Object.assign(Object.assign({},x),{[c]:P})),u&&T&&(x=Object.assign(Object.assign({},x),d(m,T))),n.createElement("dl",Object.assign({className:(0,r.A)(i.A.descriptionList,(u||y)&&i.A.modifiers.horizontal,p&&i.A.modifiers.autoColumnWidths,E&&i.A.modifiers.autoFit,(0,s.ay)(v,i.A),(0,s.ay)(C,i.A),h&&i.A.modifiers.inlineGrid,b&&i.A.modifiers.compact,y&&i.A.modifiers.fluid,f&&i.A.modifiers.fillColumns,"lg"===g&&i.A.modifiers.displayLg,"2xl"===g&&i.A.modifiers.display_2xl,t),style:x},N),l)};u.displayName="DescriptionList"},3939:(e,t,l)=>{l.d(t,{d:()=>s});var a=l(34629),n=l(63696),r=l(91106),i=l(62634);const s=e=>{var{children:t=null,className:l}=e,s=(0,a.__rest)(e,["children","className"]);return n.createElement("dd",Object.assign({className:(0,i.A)(r.A.descriptionListDescription,l)},s),n.createElement("div",{className:(0,i.A)(r.A.descriptionListText)},t))};s.displayName="DescriptionListDescription"},24974:(e,t,l)=>{l.d(t,{W:()=>s});var a=l(34629),n=l(63696),r=l(91106),i=l(62634);const s=e=>{var{className:t,children:l}=e,s=(0,a.__rest)(e,["className","children"]);return n.createElement("div",Object.assign({className:(0,i.A)(r.A.descriptionListGroup,t)},s),l)};s.displayName="DescriptionListGroup"},21639:(e,t,l)=>{l.d(t,{X:()=>s});var a=l(34629),n=l(63696),r=l(91106),i=l(62634);const s=e=>{var{children:t,className:l,icon:s}=e,o=(0,a.__rest)(e,["children","className","icon"]);return n.createElement("dt",Object.assign({className:(0,i.A)(r.A.descriptionListTerm,l)},o),s?n.createElement("span",{className:(0,i.A)(r.A.descriptionListTermIcon)},s):null,n.createElement("span",{className:(0,i.A)(r.A.descriptionListText)},t))};s.displayName="DescriptionListTerm"},23546:(e,t,l)=>{l.d(t,{o:()=>E});var a=l(34629),n=l(63696),r=l(96660),i=l(42577),s=l(62634),o=l(77635),c=l(891),m=l(85310),d=l(84632),u=l(44551),p=l(40066);class E extends n.Component{constructor(e){super(e),this.headingRef=n.createRef(),this.toggleCollapse=()=>{this.setState((e=>({isOpen:!e.isOpen,isTooltipVisible:Boolean(this.headingRef.current&&this.headingRef.current.offsetWidth<this.headingRef.current.scrollWidth)})))},this.state={isOpen:this.props.defaultIsOpen,isTooltipVisible:!1}}componentDidMount(){this.setState({isTooltipVisible:Boolean(this.headingRef.current&&this.headingRef.current.offsetWidth<this.headingRef.current.scrollWidth)})}renderLabel(e){const{categoryName:t,tooltipPosition:l}=this.props,{isTooltipVisible:a}=this.state;return a?n.createElement(m.m,{position:l,content:t},n.createElement("span",{tabIndex:0,ref:this.headingRef,className:(0,s.A)(r.A.labelGroupLabel)},n.createElement("span",{"aria-hidden":"true",id:e},t))):n.createElement("span",{ref:this.headingRef,className:(0,s.A)(r.A.labelGroupLabel),"aria-hidden":"true",id:e},t)}render(){const e=this.props,{categoryName:t,children:l,className:m,isClosable:E,isCompact:h,closeBtnAriaLabel:b,"aria-label":y,onClick:f,numLabels:g,expandedText:v,collapsedText:A,defaultIsOpen:P,tooltipPosition:T,isVertical:C,isEditable:x,hasEditableTextArea:N,editableTextAreaProps:_,addLabelControl:S}=e,L=(0,a.__rest)(e,["categoryName","children","className","isClosable","isCompact","closeBtnAriaLabel","aria-label","onClick","numLabels","expandedText","collapsedText","defaultIsOpen","tooltipPosition","isVertical","isEditable","hasEditableTextArea","editableTextAreaProps","addLabelControl"]),{isOpen:O}=this.state,w=n.Children.toArray(l),k=w.length,I=(0,u.ou)(A,{remaining:k-g}),F=e=>{const l=O?w:w.slice(0,g),a=n.createElement(n.Fragment,null,t&&this.renderLabel(e),n.createElement("ul",Object.assign({className:(0,s.A)(r.A.labelGroupList)},t&&{"aria-labelledby":e},!t&&{"aria-label":y},{role:"list"},L),l.map(((e,t)=>n.createElement("li",{className:(0,s.A)(r.A.labelGroupListItem),key:t},e))),k>g&&n.createElement("li",{className:(0,s.A)(r.A.labelGroupListItem)},n.createElement(c.J,{isOverflowLabel:!0,onClick:this.toggleCollapse,className:(0,s.A)(h&&i.A.modifiers.compact)},O?v:I)),S&&n.createElement("li",{className:(0,s.A)(r.A.labelGroupListItem)},S),x&&N&&n.createElement("li",{className:(0,s.A)(r.A.labelGroupListItem,r.A.modifiers.textarea)},n.createElement("textarea",Object.assign({className:(0,s.A)(r.A.labelGroupTextarea),rows:1,tabIndex:0},_))))),u=n.createElement("div",{className:(0,s.A)(r.A.labelGroupClose)},n.createElement(o.$n,{variant:"plain","aria-label":b,onClick:f,id:`remove_group_${e}`,"aria-labelledby":`remove_group_${e} ${e}`},n.createElement(d.Ay,{"aria-hidden":"true"})));return n.createElement("div",{className:(0,s.A)(r.A.labelGroup,m,t&&r.A.modifiers.category,C&&r.A.modifiers.vertical,x&&r.A.modifiers.editable)},n.createElement("div",{className:(0,s.A)(r.A.labelGroupMain)},a),E&&u)};return 0===k&&void 0===S?null:n.createElement(p.N,null,(e=>F(this.props.id||e)))}}E.displayName="LabelGroup",E.defaultProps={expandedText:"Show Less",collapsedText:"${remaining} more",categoryName:"",defaultIsOpen:!1,numLabels:3,isClosable:!1,isCompact:!1,onClick:e=>{},closeBtnAriaLabel:"Close label group",tooltipPosition:"top","aria-label":"Label group category",isVertical:!1,isEditable:!1,hasEditableTextArea:!1}},71743:(e,t,l)=>{l.d(t,{P:()=>u});var a=l(34629),n=l(63696);const r="pf-v5-c-truncate__end",i="pf-v5-c-truncate__start";var s,o=l(62634),c=l(85310);!function(e){e.start="start",e.end="end",e.middle="middle"}(s||(s={}));const m={start:r,end:i},d=(e,t)=>[e.slice(0,e.length-t),e.slice(-t)],u=e=>{var{className:t,position:l="end",tooltipPosition:u="top",trailingNumChars:p=7,content:E}=e,h=(0,a.__rest)(e,["className","position","tooltipPosition","trailingNumChars","content"]);return n.createElement(c.m,{position:u,content:E},n.createElement("span",Object.assign({className:(0,o.A)("pf-v5-c-truncate",t)},h),(l===s.end||l===s.start)&&n.createElement("span",{className:m[l]},E,l===s.start&&n.createElement(n.Fragment,null,"â€Ž")),l===s.middle&&E.slice(0,E.length-p).length>12&&n.createElement(n.Fragment,null,n.createElement("span",{className:i},d(E,p)[0]),n.createElement("span",{className:r},d(E,p)[1])),l===s.middle&&E.slice(0,E.length-p).length<=12&&E))};u.displayName="Truncate"},78833:(e,t,l)=>{l.d(t,{Y:()=>h});var a=l(63696),n=l(49348),r=l(34066),i=l(65753),s=l(24974),o=l(21639),c=l(3939),m=l(77635),d=l(92939),u=l(91728),p=l(67837),E=l(24417);const h=({sbomId:e})=>{const{sbom:t,isFetching:l,fetchError:h}=(0,u.rj)(e);return a.createElement(E.a,{isFetching:l,fetchError:h},a.createElement(i.B,null,a.createElement(s.W,null,a.createElement(o.X,null,"Name"),a.createElement(c.d,null,a.createElement(m.$n,{variant:"link",isInline:!0,icon:a.createElement(d.Ay,null)},a.createElement(n.k2,{to:`/sboms/${e}`},t?.name)))),a.createElement(s.W,null,a.createElement(o.X,null,"Published"),a.createElement(c.d,null,(0,r.Yq)(t?.published))),a.createElement(s.W,null,a.createElement(o.X,null,"Labels"),a.createElement(c.d,null,t?.labels&&a.createElement(p.g,{defaultIsOpen:!0,value:t?.labels})))))}},38574:(e,t,l)=>{l.d(t,{J:()=>h});var a=l(63696),n=l(49348),r=l(74932),i=l(34066),s=l(65753),o=l(24974),c=l(21639),m=l(3939),d=l(77635),u=l(92939),p=l(24417),E=l(52302);const h=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:h}=(0,r.uN)(e);return a.createElement(p.a,{isFetching:l,fetchError:h},a.createElement(s.B,null,a.createElement(o.W,null,a.createElement(c.X,null,"Identifier"),a.createElement(m.d,null,a.createElement(d.$n,{variant:"link",isInline:!0,icon:a.createElement(u.Ay,null)},a.createElement(n.k2,{to:`/vulnerabilities/${t?.identifier}`},t?.identifier)))),a.createElement(o.W,null,a.createElement(c.X,null,"Severity"),a.createElement(m.d,null,t?.average_severity&&a.createElement(E.h,{value:t?.average_severity}))),a.createElement(o.W,null,a.createElement(c.X,null,"Title"),a.createElement(m.d,null,t?.title||t?.description)),a.createElement(o.W,null,a.createElement(c.X,null,"CWE"),a.createElement(m.d,null,t?.cwe)),a.createElement(o.W,null,a.createElement(c.X,null,"Published"),a.createElement(m.d,null,(0,i.Yq)(t?.published))),a.createElement(o.W,null,a.createElement(c.X,null,"Modified"),a.createElement(m.d,null,(0,i.Yq)(t?.modified))),a.createElement(o.W,null,a.createElement(c.X,null,"Withdrawn"),a.createElement(m.d,null,(0,i.Yq)(t?.withdrawn))),a.createElement(o.W,null,a.createElement(c.X,null,"Released"),a.createElement(m.d,null,(0,i.Yq)(t?.released)))))}},40124:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Y});var a=l(63696),n=l(49348),r=l(68430),i=l(98261),s=l(75530),o=l(1180),c=l(72785),m=l(23665),d=l(70414),u=l(8210),p=l(2620),E=l(80876),h=l(17993),b=l(34066),y=l(20653),f=l(35048),g=l(4433),v=l(77635),A=l(28341),P=l(341),T=l(85578),C=l(16646),x=l(31065),N=l(77819),_=l(28516),S=l(3629),L=l(86820),O=l(33273),w=l(67837),k=l(77307),I=l(78833),F=l(1349),K=l(62520),z=l(70611),M=l(5098),W=l(91728);const X=({packageId:e})=>{const[t,l]=a.useState(null),[n,r]=a.useState(null),i=(0,z.MM)({tableName:"sboms",persistenceKeyPrefix:L.rt.sboms_by_package,columnNames:{name:"Name",published:"Published",labels:"Labels"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:O.RJ.search}]}),{result:{data:s,total:c},isFetching:m,fetchError:d}=(0,W.Qr)(e,(0,z.Ng)({...i,hubSortFieldKeys:{}})),u=(0,z.PB)({...i,idProperty:"id",currentPageItems:s,totalItemCount:c,isLoading:m,selectionState:(0,M.$)({items:s,isEqual:(e,t)=>e.id===t.id})}),{numRenderedColumns:p,currentPageItems:E,propHelpers:{toolbarProps:h,filterToolbarProps:X,paginationToolbarItemProps:q,paginationProps:$,tableProps:R,getThProps:G,getTrProps:V,getTdProps:j}}=u;return a.createElement(a.Fragment,null,a.createElement(y.M,{...h},a.createElement(f.P,null,a.createElement(O.Us,{showFiltersSideBySide:!0,...X}),a.createElement(g.T,{...q},a.createElement(F.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:$})))),a.createElement(T.X,{...R,"aria-label":"SBOM table"},a.createElement(C.d,null,a.createElement(x.Tr,null,a.createElement(K.Ze,{...u},a.createElement(N.Th,{...G({columnKey:"name"})}),a.createElement(N.Th,{...G({columnKey:"published"})}),a.createElement(N.Th,{...G({columnKey:"labels"})})))),a.createElement(K.nJ,{isLoading:m,isError:!!d,isNoData:0===c,numRenderedColumns:p},E?.map((e=>a.createElement(_.N,{key:e.id},a.createElement(x.Tr,{...V({item:e})},a.createElement(S.Td,{width:35,...j({columnKey:"name"})},a.createElement(v.$n,{size:"sm",variant:v.Ak.secondary,onClick:()=>{return t=e,l("showSbom"),void r(t);var t}},e.name)),a.createElement(S.Td,{width:10,modifier:"truncate",...j({columnKey:"published"})},(0,b.Yq)(e.published)),a.createElement(S.Td,{width:35,modifier:"truncate",...j({columnKey:"labels"})},e.labels&&a.createElement(w.g,{value:e.labels})))))))),a.createElement(F.n,{idPrefix:"sboms-table",isTop:!1,isCompact:!0,paginationProps:$}),a.createElement(k.q,{isExpanded:null!==t,onCloseClick:()=>l(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showSbom"===t&&a.createElement(o.n,null,a.createElement(A.h,{headingLevel:"h2",size:"lg",className:P.A.mtXs},"Advisory")))},"showSbom"===t&&a.createElement(a.Fragment,null,n&&a.createElement(I.Y,{sbomId:n.id}))))};var q=l(891),$=l(80863),R=l(52302),G=l(15311),V=l(38574),j=l(40752),B=l(77347),J=l(70400);const D=({packageId:e})=>{const[t,l]=a.useState(null),[n,r]=a.useState(null),i=(e,t)=>{l(e),r(t)},{pkg:s,isFetching:c,fetchError:m}=(0,h.Si)(e),[d,u]=a.useState([]),[p,E]=a.useState(new Map),[b,L]=a.useState(!1),[w,I]=a.useState(new Set);a.useEffect((()=>{const e=(s?.advisories??[]).flatMap((e=>e.status.map((t=>({vulnerabilityId:t.vulnerability.identifier,status:t.status,context:t.context,advisory:e}))))).reduce(((e,t)=>e.find((e=>e.vulnerabilityId===t.vulnerabilityId&&e.advisory.uuid===t.advisory.uuid))?e:[...e,t]),[]),t=new Set;e.forEach((e=>t.add(e.status))),u(e),I(t),L(!0),Promise.all(e.map((async e=>(await(0,j.dZ)({client:B.S,path:{id:e.vulnerabilityId}})).data)).map((e=>e.catch((()=>null))))).then((e=>{const t=e.reduce(((e,t)=>t?[...e,t]:e),[]),l=new Map;t.forEach((e=>l.set(e.identifier,e))),E(l),L(!1)}))}),[s]);const M=a.useMemo((()=>d.map((e=>({...e,vulnerability:p.get(e.vulnerabilityId)})))),[d,p]),W=(0,G.f)(M,(e=>`${e.vulnerabilityId}-${e.advisory.identifier}-${e.advisory.uuid}`)),X=(0,z.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:W,isLoading:!1,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",advisory:"Advisory",context:"Context",status:"Status"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["identifier"],getSortValues:e=>({identifier:e.vulnerabilityId}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:O.RJ.search,getItemValue:e=>e.vulnerabilityId},{categoryKey:"status",title:"Status",placeholderText:"Status",type:O.RJ.multiselect,selectOptions:Array.from(w).map((e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}))),matcher:(e,t)=>t.status===e}],isExpansionEnabled:!1}),{currentPageItems:D,numRenderedColumns:Y,propHelpers:{toolbarProps:U,filterToolbarProps:H,paginationToolbarItemProps:Z,paginationProps:Q,tableProps:ee,getThProps:te,getTrProps:le,getTdProps:ae},expansionDerivedState:{isCellExpanded:ne}}=X;return a.createElement(a.Fragment,null,a.createElement(y.M,{...U},a.createElement(f.P,null,a.createElement(O.Us,{showFiltersSideBySide:!0,...H}),a.createElement(g.T,{...Z},a.createElement(F.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:Q})))),a.createElement(T.X,{...ee,"aria-label":"vulnerability table"},a.createElement(C.d,null,a.createElement(x.Tr,null,a.createElement(K.Ze,{...X},a.createElement(N.Th,{...te({columnKey:"identifier"})}),a.createElement(N.Th,{...te({columnKey:"title"})}),a.createElement(N.Th,{...te({columnKey:"severity"})}),a.createElement(N.Th,{...te({columnKey:"advisory"})}),a.createElement(N.Th,{...te({columnKey:"context"})}),a.createElement(N.Th,{...te({columnKey:"status"})})))),a.createElement(K.nJ,{isLoading:c||b,isError:!!m,isNoData:0===W.length,numRenderedColumns:Y},D?.map(((e,t)=>a.createElement(_.N,{key:e._ui_unique_id,isExpanded:ne(e)},a.createElement(x.Tr,{...le({item:e})},a.createElement(K.Oi,{...X,item:e,rowIndex:t},a.createElement(S.Td,{width:15,...ae({columnKey:"identifier"})},a.createElement(v.$n,{size:"sm",variant:v.Ak.secondary,onClick:()=>i("showVulnerability",e)},e.vulnerabilityId)),a.createElement(S.Td,{width:35,modifier:"truncate",...ae({columnKey:"title"})},e.vulnerability?.title),a.createElement(S.Td,{width:10,...ae({columnKey:"severity"})},e.vulnerability?.average_severity&&a.createElement(R.h,{value:e.vulnerability.average_severity})),a.createElement(S.Td,{width:15,modifier:"truncate",...ae({columnKey:"advisory"})},a.createElement(v.$n,{size:"sm",variant:v.Ak.secondary,onClick:()=>i("showAdvisory",e)},e.advisory.identifier)),a.createElement(S.Td,{width:25,modifier:"truncate",...ae({columnKey:"context"})},a.createElement(J.L,{value:e.context})),a.createElement(S.Td,{width:10,modifier:"truncate",...ae({columnKey:"status"})},a.createElement(q.J,null,e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("_"," ")))))))))),a.createElement(F.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:Q}),a.createElement(k.q,{isExpanded:null!==t,onCloseClick:()=>l(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showVulnerability"===t&&a.createElement(o.n,null,a.createElement(A.h,{headingLevel:"h2",size:"lg",className:P.A.mtXs},"Vulnerability")),"showAdvisory"===t&&a.createElement(o.n,null,a.createElement(A.h,{headingLevel:"h2",size:"lg",className:P.A.mtXs},"Advisory")))},"showVulnerability"===t&&a.createElement(a.Fragment,null,n?.advisory&&a.createElement(V.J,{vulnerabilityId:n?.vulnerabilityId}))," ","showAdvisory"===t&&a.createElement(a.Fragment,null,n?.advisory&&a.createElement($.c,{advisoryId:n?.advisory.uuid}))))},Y=()=>{const e=(0,E.Lu)(E.vO.PACKAGE_ID),{pkg:t}=(0,h.Si)(e),l=a.useMemo((()=>t?(0,b.fe)(t.purl):void 0),[t]);return a.createElement(a.Fragment,null,a.createElement(r.d8,{variant:"light"},a.createElement(p.A,{breadcrumbs:a.createElement(i.Q,null,a.createElement(s.J,{key:"packages"},a.createElement(n.N_,{to:"/packages"},"Packages")),a.createElement(s.J,{isActive:!0},"Package details")),pageHeading:{title:l?.name??e??"",iconAfterTitle:t?a.createElement(o.n,null,a.createElement(c.E,{component:"pre"},`version: ${l?.version}`)):void 0,label:t?{children:t?`type=${l?.type}`:"",isCompact:!0}:void 0},actionButtons:[],tabs:[{eventKey:"vulnerabilities",title:"Vulnerabilities",children:a.createElement("div",{className:"pf-v5-u-m-md"},e&&a.createElement(D,{packageId:e})),actions:a.createElement(a.Fragment,null,a.createElement(m.A,{bodyContent:a.createElement("div",null,"Vulnerabilities ",a.createElement("strong",null,"associated")," to the current package."),position:"top"},a.createElement(d.o,null,a.createElement(u.Ay,null))))},{eventKey:"sboms",title:"SBOMs",children:a.createElement("div",{className:"pf-v5-u-m-md"},e&&a.createElement(X,{packageId:e})),actions:a.createElement(a.Fragment,null,a.createElement(m.A,{bodyContent:a.createElement("div",null,"SBOMs that ",a.createElement("strong",null,"contain")," the current package."),position:"top"},a.createElement(d.o,null,a.createElement(u.Ay,null))))}]})))}},70400:(e,t,l)=>{l.d(t,{n:()=>I,L:()=>k});var a=l(63696),n=l(20653),r=l(35048),i=l(4433),s=l(77635),o=l(891),c=l(1180),m=l(28341),d=l(341),u=l(85578),p=l(16646),E=l(31065),h=l(77819),b=l(28516),y=l(3629),f=l(80863),g=l(33273),v=l(65753),A=l(24974),P=l(21639),T=l(3939),C=l(16177);const x=({decomposedPurl:e})=>a.createElement(v.B,null,a.createElement(A.W,null,a.createElement(P.X,null,"Name"),a.createElement(T.d,null,e.name)),a.createElement(A.W,null,a.createElement(P.X,null,"Namespace"),a.createElement(T.d,null,e.namespace)),a.createElement(A.W,null,a.createElement(P.X,null,"Type"),a.createElement(T.d,null,e.type)),e.version&&a.createElement(A.W,null,a.createElement(P.X,null,"Version"),a.createElement(T.d,null,e.version)),e.path&&a.createElement(A.W,null,a.createElement(P.X,null,"Path"),a.createElement(T.d,null,e.path)),e.qualifiers&&a.createElement(A.W,null,a.createElement(P.X,null,"Qualifiers"),a.createElement(T.d,null,a.createElement(C.a,{value:e.qualifiers}))));var N=l(77307),_=l(1349),S=l(62520),L=l(70611),O=l(15311),w=l(34066);const k=({value:e})=>{if(!e)return null;let t=e;return t.cpe?t.cpe:e.purl},I=({variant:e,initialItemsPerPage:t,advisories:l})=>{const[v,A]=a.useState(null),[P,T]=a.useState(null),C=(e,t)=>{A(e),T(t)},I=a.useMemo((()=>l.flatMap((e=>Object.entries(e.purls??{}).flatMap((([t,l])=>l.map((l=>{const a=l.base_purl;return{basePurl:{...a},advisory:{...e},status:t,context:l.context,versionRange:l.version,decomposedPurl:(0,w.fe)(a.purl)}}))))))),[l]),F=(0,O.f)(I,(e=>`${e.basePurl.purl}-${e.advisory.identifier}-${e.status}`)),K=a.useMemo((()=>{const e=new Set;return I.forEach((t=>e.add(t.status))),e}),[I]),z=(0,L.vY)({variant:e,tableName:"package-table",idProperty:"_ui_unique_id",items:F,isLoading:!1,columnNames:{name:"Name",namespace:"Namespace",affectedVersions:"Affected version",advisory:"Advisory",context:"Context",status:"Status"},hasActionsColumn:!1,isSortEnabled:!1,sortableColumns:["name"],getSortValues:e=>({name:e.decomposedPurl?.name??e.basePurl.purl}),isPaginationEnabled:!0,initialItemsPerPage:t,isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:g.RJ.search,getItemValue:e=>e.decomposedPurl?.name??e.basePurl.purl},{categoryKey:"status",title:"Status",placeholderText:"Status",type:g.RJ.multiselect,selectOptions:Array.from(K).map((e=>({value:e,label:e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")}))),matcher:(e,t)=>t.status===e}],isExpansionEnabled:!1}),{currentPageItems:M,numRenderedColumns:W,propHelpers:{toolbarProps:X,filterToolbarProps:q,paginationToolbarItemProps:$,paginationProps:R,tableProps:G,getThProps:V,getTrProps:j,getTdProps:B}}=z;return a.createElement(a.Fragment,null,a.createElement(n.M,{...X},a.createElement(r.P,null,a.createElement(g.Us,{showFiltersSideBySide:!0,...q}),a.createElement(i.T,{...$},a.createElement(_.n,{idPrefix:"package-table",isTop:!0,paginationProps:R})))),a.createElement(u.X,{...G,"aria-label":"Package table"},a.createElement(p.d,null,a.createElement(E.Tr,null,a.createElement(S.Ze,{...z},a.createElement(h.Th,{...V({columnKey:"name"})}),a.createElement(h.Th,{...V({columnKey:"namespace"})}),a.createElement(h.Th,{...V({columnKey:"affectedVersions"})}),a.createElement(h.Th,{...V({columnKey:"advisory"})}),a.createElement(h.Th,{...V({columnKey:"context"})}),a.createElement(h.Th,{...V({columnKey:"status"})})))),a.createElement(S.nJ,{isLoading:!1,isError:void 0,isNoData:0===I.length,numRenderedColumns:W},M?.map(((e,t)=>a.createElement(b.N,{key:e.basePurl.purl},a.createElement(E.Tr,{...j({item:e})},a.createElement(S.Oi,{...z,item:e,rowIndex:t},a.createElement(y.Td,{width:25,modifier:"truncate",...B({columnKey:"name"})},a.createElement(s.$n,{size:"sm",variant:s.Ak.secondary,onClick:()=>C("showPackage",e)},e.decomposedPurl?e.decomposedPurl?.name:e.basePurl.purl)),a.createElement(y.Td,{width:15,modifier:"truncate",...B({columnKey:"namespace"})},e.decomposedPurl?.namespace),a.createElement(y.Td,{width:10,...B({columnKey:"affectedVersions"})},a.createElement(o.J,{color:"grey"},e.versionRange)),a.createElement(y.Td,{width:15,modifier:"truncate",...B({columnKey:"advisory"})},a.createElement(s.$n,{size:"sm",variant:s.Ak.secondary,onClick:()=>C("showAdvisory",e)},e.advisory.identifier)),a.createElement(y.Td,{width:25,modifier:"truncate",...B({columnKey:"context"})},a.createElement(k,{value:e.context})),a.createElement(y.Td,{width:10,modifier:"truncate",...B({columnKey:"status"})},a.createElement(o.J,null,e.status.charAt(0).toUpperCase()+e.status.slice(1).replace("_"," ")))))))))),a.createElement(_.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:R}),a.createElement(N.q,{isExpanded:null!==v,onCloseClick:()=>A(null),pageKey:"drawer",drawerPanelContentProps:{defaultSize:"600px"},header:a.createElement(a.Fragment,null,"showPackage"===v&&a.createElement(c.n,null,a.createElement(m.h,{headingLevel:"h2",size:"lg",className:d.A.mtXs},"Package")),"showAdvisory"===v&&a.createElement(c.n,null,a.createElement(m.h,{headingLevel:"h2",size:"lg",className:d.A.mtXs},"Advisory")))},"showPackage"===v&&a.createElement(a.Fragment,null,P?.decomposedPurl&&a.createElement(x,{decomposedPurl:P?.decomposedPurl})),"showAdvisory"===v&&a.createElement(a.Fragment,null,P?.advisory&&a.createElement(f.c,{advisoryId:P?.advisory.uuid}))))}},17993:(e,t,l)=>{l.d(t,{Lx:()=>c,Si:()=>m,sl:()=>d});var a=l(7616),n=l(6841),r=l(40752),i=l(77347),s=l(70611);const o="packages",c=(e={},t=!1)=>{const l=(0,a.I)({queryKey:[o,e],queryFn:()=>(0,n.q)((0,r.UD)({client:i.S,query:{...(0,s.kd)(e)}})),refetchInterval:!t&&5e3});return{...(0,n.S)(l),result:{data:l.data?.items||[],total:l.data?.total??0,params:e}}},m=e=>{const t=(0,a.I)({queryKey:[o,e],queryFn:()=>(0,n.q)((0,r.Y0)({client:i.S,path:{key:e}}))});return{...(0,n.S)(t),pkg:t.data}},d=(e,t={})=>{const l=(0,a.I)({queryKey:[o,"by-sbom",e,t],queryFn:()=>(0,n.q)((0,r.Ad)({client:i.S,path:{id:e},query:{...(0,s.kd)(t)}}))});return{...(0,n.S)(l),result:{data:l.data?.items||[],total:l.data?.total??0,params:t}}}},91106:(e,t,l)=>{l.d(t,{A:()=>a});const a={card:"pf-v5-c-card",descriptionList:"pf-v5-c-description-list",descriptionListDescription:"pf-v5-c-description-list__description",descriptionListGroup:"pf-v5-c-description-list__group",descriptionListTerm:"pf-v5-c-description-list__term",descriptionListTermIcon:"pf-v5-c-description-list__term-icon",descriptionListText:"pf-v5-c-description-list__text",modifiers:{inlineGrid:"pf-m-inline-grid",autoColumnWidths:"pf-m-auto-column-widths",autoFit:"pf-m-auto-fit",compact:"pf-m-compact",fluid:"pf-m-fluid",fillColumns:"pf-m-fill-columns",displayLg:"pf-m-display-lg",display_2xl:"pf-m-display-2xl",helpText:"pf-m-help-text","1Col":"pf-m-1-col","2Col":"pf-m-2-col","3Col":"pf-m-3-col",horizontal:"pf-m-horizontal",vertical:"pf-m-vertical","1ColOnSm":"pf-m-1-col-on-sm","2ColOnSm":"pf-m-2-col-on-sm","3ColOnSm":"pf-m-3-col-on-sm",horizontalOnSm:"pf-m-horizontal-on-sm",verticalOnSm:"pf-m-vertical-on-sm","1ColOnMd":"pf-m-1-col-on-md","2ColOnMd":"pf-m-2-col-on-md","3ColOnMd":"pf-m-3-col-on-md",horizontalOnMd:"pf-m-horizontal-on-md",verticalOnMd:"pf-m-vertical-on-md","1ColOnLg":"pf-m-1-col-on-lg","2ColOnLg":"pf-m-2-col-on-lg","3ColOnLg":"pf-m-3-col-on-lg",horizontalOnLg:"pf-m-horizontal-on-lg",verticalOnLg:"pf-m-vertical-on-lg","1ColOnXl":"pf-m-1-col-on-xl","2ColOnXl":"pf-m-2-col-on-xl","3ColOnXl":"pf-m-3-col-on-xl",horizontalOnXl:"pf-m-horizontal-on-xl",verticalOnXl:"pf-m-vertical-on-xl","1ColOn_2xl":"pf-m-1-col-on-2xl","2ColOn_2xl":"pf-m-2-col-on-2xl","3ColOn_2xl":"pf-m-3-col-on-2xl",horizontalOn_2xl:"pf-m-horizontal-on-2xl",verticalOn_2xl:"pf-m-vertical-on-2xl"}}}}]);
//# sourceMappingURL=907.8972951d.min.js.map